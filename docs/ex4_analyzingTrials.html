<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Pre- to post-treatment analysis</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">IDR3002 Course notes</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Software
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="installation.html">Installing and starting up R and RStudio</a>
    </li>
    <li>
      <a href="markdown.html">Creating a report using rmarkdown</a>
    </li>
    <li>
      <a href="structure.html">Structuring an analysis</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Lessons
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="introduction_1.html">Introduction to R</a>
    </li>
    <li>
      <a href="import_data.html">Import data</a>
    </li>
    <li>
      <a href="make_summaries.html">Make summaries</a>
    </li>
    <li>
      <a href="plot_ggplot2.html">Create plots with ggplot2</a>
    </li>
    <li>
      <a href="descriptive_statistics.html">Assignment: Descriptive statistics</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="ex2_introInference.html">Statistical inference</a>
    </li>
    <li>
      <a href="ex2_introInference2.html">Statistical inference 2</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="ex3_regressionModels.html">Regression models</a>
    </li>
    <li>
      <a href="ex4_analyzingTrials.html">Extendning regression models</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Exercises
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="ex1_intro.html">Introduction to R and RStudio</a>
    </li>
    <li>
      <a href="ex1_import.html">Import data</a>
    </li>
    <li>
      <a href="ex1_summarise.html">Summarise data</a>
    </li>
    <li>
      <a href="ex1_figures.html">Making figures</a>
    </li>
    <li>
      <a href="exercise_week3.html">Regression models</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Assignments
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="assignments_week1.html">Week 1</a>
    </li>
    <li>
      <a href="assignments_week2.html">Week 2</a>
    </li>
    <li>
      <a href="assignments_week3.html">Week 3</a>
    </li>
    <li>
      <a href="assignments_week4.html">Week 4</a>
    </li>
    <li>
      <a href="assignments_week5.html">Week 5</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="faq.html">
    <span class="fa fa-question fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Pre- to post-treatment analysis</h1>

</div>


<div id="single-vs.-multiple-sets" class="section level2">
<h2>Single vs. multiple sets</h2>
<p>In this study, n = 34 participants were randomized to completed a strength training intervention with multiple-set and single-set randomized to either leg. Strength was evaluated as isokinetic strength at 60, 120 and 240 degrees and isometric strength, all using knee extension. In these exercises we will analyze data were participants have been selected either to belong to the single- or multiple-set group. This means we will only analyze one leg per participant!</p>
<div id="the-data-set" class="section level3">
<h3>The data set</h3>
<p>The data set contains six variables:</p>
<ul>
<li><code>subject</code></li>
<li><code>timepoint</code> (<code>pre</code>=Pre-training, <code>session1</code>=Pre-training second test, <code>post</code>=Post training)</li>
<li><code>exercise</code> (<code>isok.60</code>=Isokinetic 60 degrees per sec, <code>isok.120</code>, <code>isok.240</code>, <code>isom</code>=Isometric)</li>
<li><code>load</code> (Peak torque in Nm)</li>
<li><code>sex</code> (<code>male</code>, <code>female</code>)</li>
<li><code>group</code> (<code>multiple</code>, <code>single</code>)</li>
</ul>
<p>The data can be found in <code>strengthTests.csv</code> on canvas. Use the <code>read_csv()</code> function (loaded in tidyverse) to load the data:</p>
<pre class="r"><code>strength &lt;- read_csv(&quot;./data/strengthTests.csv&quot;) %&gt;%
  print()</code></pre>
</div>
<div id="exploratory-analysis" class="section level3">
<h3>Exploratory analysis</h3>
<p>Use descriptive methods (summary statistics and figures to describe results from the trial). What are the mean and standard deviations of the <code>load</code> variable for each <code>timepoint</code>, <code>exercise</code> and <code>group</code>. Use tables and figures to show the results.</p>
<script language="javascript"> 
    function toggle(num) {
      var ele = document.getElementById("toggleText" + num);
      var text = document.getElementById("displayText" + num);
      if(ele.style.display == "block") {
        ele.style.display = "none";
        text.innerHTML = "show";
      }
      else {
        ele.style.display = "block";
        text.innerHTML = "hide";
      }
   } 
  </script>
<a id="displayText" href="javascript:toggle(1);">Here is a possible solution for a table</a>
<div id="toggleText1" style="display: none">
<p>We want to summarize data per group, exercise and time-point and we want the means, standard deviations and the number of observations.</p>
<pre class="r"><code>strength_summary &lt;- read_csv(&quot;./data/strengthTests.csv&quot;) %&gt;% 
        group_by(exercise, timepoint, group) %&gt;%
        summarise(Mean = mean(load, na.rm = TRUE), 
                  SD = sd(load, na.rm = TRUE), 
                  n = n()) 


# To create a table we need the kable function from the knitr package

library(knitr)

strength_summary %&gt;%
kable(digits = c(NA, NA, NA, 1, 1, 0), 
      col.names = c(&quot;Exercise&quot;, &quot;Time-point&quot;, &quot;Group&quot;, &quot;Mean&quot;, &quot;SD&quot;, &quot;n&quot;))</code></pre>
</div>
<p></br></p>
<a id="displayText" href="javascript:toggle(2);">Here is a possible solution for a figure</a>
<div id="toggleText2" style="display: none">
<p>Using the same summary statistics, we can create a figure. We might want to sort variables so that time-points are in the right order. In the figure we can use geom_errorbar to display SD</p>
<pre class="r"><code># create a position for all variables and store in object
pos &lt;- position_dodge(width = 0.2)


strength_summary %&gt;%
        ungroup() %&gt;% # Needed to mutate the timepoint variable
        mutate(timepoint = factor(timepoint, levels = c(&quot;pre&quot;, &quot;session1&quot;, &quot;post&quot;))) %&gt;%
        ggplot(aes(timepoint, Mean, color = group, group = group)) + 
        geom_errorbar(aes(ymin = Mean - SD, ymax = Mean + SD), position = pos) +
        geom_line(position = pos) +
        geom_point(shape = 21, position = pos) + 
                facet_wrap(~exercise, scales = &quot;free&quot;)</code></pre>
</div>
<p></br></p>
<p>What can you say about the effect of single- vs. multiple-sets training on muscle strength using these observations?</p>
</div>
<div id="change-from-baseline" class="section level3">
<h3>Change from baseline</h3>
<p>We will now focus on the change from baseline (<code>pre</code>) to the <code>post</code> time-point. To only use this data, use the filter function:</p>
<pre class="r"><code>strength &lt;- read_csv(&quot;./data/strengthTests.csv&quot;) %&gt;% 
        filter(timepoint != &quot;session1&quot;) %&gt;%
        print()</code></pre>
<p>Calculate the average percentage change from baseline (<code>pre</code>) in each group and create a graph of the results. Focus on the isokinetic test performed at 120 degrees per second (<code>isok.120</code>). Make a plan of your code before you start writing it!</p>
<a id="displayText" href="javascript:toggle(3);">Here is a possible solution for a figure</a>
<div id="toggleText3" style="display: none">
<p>Here we want to perform the following steps:</p>
<ol style="list-style-type: decimal">
<li>Filter the data to only contain <code>pre</code> and <code>post</code> time-points and <code>exercise == "isok.120"</code></li>
<li>Make the data set wider and calculate percentage change as <span class="math inline">\(\frac{post-pre}{pre} \times 100\)</span></li>
<li>Group the data set by group and exercise</li>
<li>Summarize the data and create a figure with groups on the x-axis and %-change on the y-axis.</li>
</ol>
<a id="displayText" href="javascript:toggle(4);">Example code</a>
<div id="toggleText4" style="display: none">
<pre class="r"><code>read_csv(&quot;./data/strengthTests.csv&quot;) %&gt;% 
        filter(timepoint != &quot;session1&quot;, 
               exercise == &quot;isok.120&quot;) %&gt;%
        pivot_wider(names_from = timepoint, 
                    values_from = load) %&gt;%
        mutate(change = (post-pre) / pre * 100) %&gt;%
        group_by(group, exercise) %&gt;%
        summarise(m = mean(change, na.rm = TRUE), 
                  s = sd(change, na.rm = TRUE)) %&gt;%
        ggplot(aes(group, m)) + 
        geom_errorbar(aes(ymin = m - s, ymax = m + s)) +
        geom_point()

## How would you add a more attractive theme to the plot?</code></pre>
</div>
<p></br></p>
</div>
<p></br></p>
</div>
<div id="model-the-change" class="section level3">
<h3>Model the change</h3>
<p>The present data set is an example of a simple randomized trial. Participants have been randomized to either treatment before the trial and we are interested in the difference in treatments. There are several options for analyzing these data. A simple alternative would be to analyse the difference in post-training values with a t-test. This is not very efficient in terms of statistical power, i.e. we would need a lot of participants to show a difference if it existed due to differences between participants. In the case of the present data set, we have also collected more data than just follow-up scores. These baseline scores can be used to calculate a change-score which in turn can be used to compare treatments. This is a more direct comparison related to our actual question. We want to know what treatment is more effective in <em>improving</em> strength.</p>
<p>An example. We focus on the <code>isok.120</code> data. State a hypothesis that compares the two groups and run a test that test against the corresponding null-hypothesis. Remember that we did this using both <code>t.test()</code> and <code>lm()</code>. Using <code>var.equal = TRUE</code> do the corresponding test also in <code>lm</code>. Write a short summary of your results!</p>
<a id="displayText" href="javascript:toggle(5);">Example code</a>
<div id="toggleText5" style="display: none">
<pre class="r"><code>tt_data &lt;- read_csv(&quot;./data/strengthTests.csv&quot;) %&gt;% 
        filter(timepoint != &quot;session1&quot;) %&gt;%
        pivot_wider(names_from = timepoint, 
                    values_from = load) %&gt;%
        mutate(change = (post-pre) / pre * 100) %&gt;%
        filter(exercise == &quot;isok.120&quot;)

## The t.test

t.test(change ~ group, data = tt_data, var.equal = TRUE)

## The linear model

summary(lm(change ~ group, data = tt_data))</code></pre>
</div>
<p></br></p>
</div>
<div id="accounting-for-the-baseline-regression-to-the-mean-and-extending-the-linear-model" class="section level3">
<h3>Accounting for the baseline – Regression to the mean and extending the linear model</h3>
<p>Above we created a linear model from where you got exactly the same results as from the t-test. In this section we will see that the linear model is easily extended to create more robust statistics of change scores.</p>
<p>When we have calculated a change score (e.g. percentage change), this score might be related to the baseline. This can be expected due to a phenomena known as regression towards the mean. When we do repeated testing on the same participants, test scores that were close to the upper or lower limit of a participant potential scores will be replaced with a score closer to the mean. This in turn will create a negative association between initial values and change.</p>
<p>Using the strength test data-set, calculate the change score using <span class="math inline">\(\frac{post-pre}{pre} *100\)</span> and evaluate the association between change (y-axis) and baseline (x-axis) with a graph. Use <code>+ facte_wrap(~exercise, scales = "free")</code> to get get a panel for each exercise.</p>
<p>How do you interpret the graphs?</p>
<a id="displayText" href="javascript:toggle(6);">Example code</a>
<div id="toggleText6" style="display: none">
<pre class="r"><code>read_csv(&quot;./data/strengthTests.csv&quot;) %&gt;% 
        pivot_wider(names_from = timepoint, 
                    values_from = load) %&gt;%
        mutate(change = (post-pre) / pre * 100) %&gt;%
  ggplot(aes(pre, change)) + geom_point() + geom_smooth(method = &quot;lm&quot;) + facet_wrap(~exercise, scales = &quot;free&quot;)</code></pre>
</div>
<p></br></p>
<p>An association between baseline and change scores means possible problems when we want to compare groups in the ordinary linear model. We can think of it in two ways. In the ordinary linear model (or the t-test of change scores) there is some unexplained variation that goes into the standard errors making it harder to see differences between groups. Taking the relationship into account creates a more powerful model. Secondly, there might be slight differences between groups in the baseline, when accounted for, we get an estimate of the difference between groups taking the baseline into account.</p>
<p>This extended model is called ANCOVA (ANalysis of CO-VAriance). The ordinary linear model we use above can be written as:</p>
<p><span class="math display">\[Change = \beta_0 + \beta_1 \times Group\]</span></p>
<p>The extended, ANCOVA model can be written as</p>
<p><span class="math display">\[Change =  \beta_0 + \beta_1 \times Baseline + \beta_2 \times Group\]</span></p>
<p>In the following example we will use <code>isom</code> to infer on the effect of single- vs. multiple-set training. We will use the pre- to post training scores for change score calculations. In the data set we have men and women, to get an unbiased association to the baseline, we will mean center the pre-values per sex.</p>
<pre class="r"><code>change.data &lt;- read_csv(&quot;./data/strengthTests.csv&quot;) %&gt;% 
        pivot_wider(names_from = timepoint, 
                    values_from = load) %&gt;%
          mutate(change = (post-pre) / pre * 100) %&gt;%
  group_by(sex) %&gt;%
  mutate(pre = pre - mean(pre)) %&gt;%
  filter(exercise == &quot;isom&quot;) 


# An ordinary lm
m1 &lt;- lm(change ~ group, data = change.data)

# An ancova
m2 &lt;- lm(change ~ pre + group, data = change.data)</code></pre>
<p><strong>Side note:</strong> To get nice summaries of the model we will use <code>kable()</code> from the <code>knitr</code> package and <code>tidy()</code> from the <code>broom</code> package.</p>
<pre class="r"><code>library(knitr); library(broom)

tidy(m1) %&gt;%
  kable(col.names = c(&quot;Parameter&quot;, &quot;Estimate&quot;, &quot;SE&quot;, &quot;t-statistic&quot;, &quot;P-value&quot;), 
        caption = &quot;The ordinary linear model&quot;, digits = c(NA, 2, 2, 2, 3)) </code></pre>
<table>
<caption>The ordinary linear model</caption>
<thead>
<tr class="header">
<th align="left">Parameter</th>
<th align="right">Estimate</th>
<th align="right">SE</th>
<th align="right">t-statistic</th>
<th align="right">P-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">29.71</td>
<td align="right">4.46</td>
<td align="right">6.66</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">groupsingle</td>
<td align="right">-11.51</td>
<td align="right">6.22</td>
<td align="right">-1.85</td>
<td align="right">0.074</td>
</tr>
</tbody>
</table>
<pre class="r"><code>tidy(m2) %&gt;%
  kable(col.names = c(&quot;Parameter&quot;, &quot;Estimate&quot;, &quot;SE&quot;, &quot;t-statistic&quot;, &quot;P-value&quot;), 
        caption = &quot;The ANCOVA model&quot;, digits = c(NA, 2, 2, 2, 3))</code></pre>
<table>
<caption>The ANCOVA model</caption>
<thead>
<tr class="header">
<th align="left">Parameter</th>
<th align="right">Estimate</th>
<th align="right">SE</th>
<th align="right">t-statistic</th>
<th align="right">P-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">40.39</td>
<td align="right">4.91</td>
<td align="right">8.23</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">pre</td>
<td align="right">-0.19</td>
<td align="right">0.06</td>
<td align="right">-3.48</td>
<td align="right">0.002</td>
</tr>
<tr class="odd">
<td align="left">groupsingle</td>
<td align="right">-10.95</td>
<td align="right">5.34</td>
<td align="right">-2.05</td>
<td align="right">0.049</td>
</tr>
</tbody>
</table>
<p>In this case, modelling change-scores (percentage-change) together with the baseline makes a difference. We can be more confident on the results as some of the unexplained variation is cached in the association with the baseline.</p>
<p>We can use confidence intervals to see the estimates for the group effect:</p>
<pre class="r"><code>data.frame(model = c(&quot;Linear-model&quot;, &quot;ANCOVA&quot;), 
           lower.CI = c(confint(m1)[2], confint(m2)[3]), 
           upper.CI = c(confint(m1)[4], confint(m2)[6])) %&gt;%
  kable(col.names = c(&quot;Model&quot;, &quot;Lower CI&quot;, &quot;Upper CI&quot;))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="right">Lower CI</th>
<th align="right">Upper CI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Linear-model</td>
<td align="right">-24.19385</td>
<td align="right">1.1663784</td>
</tr>
<tr class="even">
<td align="left">ANCOVA</td>
<td align="right">-21.85448</td>
<td align="right">-0.0548598</td>
</tr>
</tbody>
</table>
<p>These result will not repeat for all tests, but generally, the ANCOVA has more power and represents a good way of controlling for baseline measurements in change score analysis <span class="citation">(Vickers and Altman 2001; Senn 2006)</span>.</p>
<div id="exercises" class="section level4">
<h4>Exercises</h4>
<p>Perform an analysis of <code>isok.120</code> data, infer on the effect of single- vs. multiple-sets on change in strength using the confidence intervals from an ANCOVA model. Remember to mean center the baseline per sex.</p>
<a id="displayText" href="javascript:toggle(7);">Example code</a>
<div id="toggleText7" style="display: none">
<pre class="r"><code># Store the data set 

# Load data
change.data &lt;- read_csv(&quot;./data/strengthTests.csv&quot;) %&gt;% 
  # Pivot to a wide format for change calculation
        pivot_wider(names_from = timepoint, 
                    values_from = load) %&gt;% 
  # Calculate the change
          mutate(change = (post-pre) / pre * 100) %&gt;%
  # Mean center pre-variable with grouping on sex
  group_by(sex) %&gt;%
  mutate(pre = pre - mean(pre)) %&gt;%
  # Only use the isok.120 data
  filter(exercise == &quot;isok.120&quot;) 



# Create the model
m1 &lt;- lm(change ~ pre + group, data = change.data)

# Get confidence intervals
confint(m1)[c(3, 6)]

# Interpretation of the model 
summary(m1)

# The average %-change of the single-set group was ~5.6%-point lower than the multiple-set group. This effect was not significant on the 5% level. </code></pre>
</div>
<p></br></p>
</div>
</div>
<div id="accounting-for-the-baseline-differences-between-group-and-mixed-models" class="section level3">
<h3>Accounting for the baseline – Differences between group and mixed models</h3>
<p>In a randomized trial, there might be difference between groups at baseline just by chance. These differences can be controlled for using the ANCOVA model as described above. Another way to account for the baseline is to analyze raw scores (not e.g. percentage change) given potential baseline differences. This can be done using another “extension” of the ordinary linear model, the mixed effects model.</p>
<div id="statistical-name-dropping" class="section level4">
<h4>Statistical name dropping</h4>
<p>Here we will very briefly talk about <em>mixed effects models</em> (or <em>linear mixed models</em>, or <em>hierarchical models</em>) which are models for <em>continuous outcomes</em> with <em>normally distributed errors</em>. These models can account for <em>non-independence</em> between data-points, meaning that we can fit a model using <em>correlated data</em>. This is advantageous when we want to analyze the same participants in a time-course manner (<em>repeated measures design</em>). Traditionally in exercise science, this has been done using <em>repeated measures analysis of variance</em> (<em>repeated measures ANOVA</em>). One might say that this is an outdated technique as the modern <em>mixed effects model</em> is more flexible and robust as it allows for e.g. <em>unbalanced data</em> (e.g. different number of participants in each group), <em>missing data</em> and more complex model formulations.</p>
<p>The purpose of this section is to introduce a simple mixed effects model. The mixed effects model can be extended to other problems and it is related to the <em>generalized linear models</em> that brings further flexibility as data from different distributions can be modeled.</p>
</div>
<div id="the-model" class="section level4">
<h4>The model</h4>
<p>The thing with a mixed model is that it contains to kinds of effects. In our previous models (made with <code>lm()</code>), we have dealt with “fixed effects”, these are the effects we try to estimate. This can be the difference between groups, or the slope in a model where we try to explain VO<sub>2max</sub> with height. In the mixed model, we also include “random effects”. In the simple case we can think of these as a separate starting point in the model for each participant. This simple case is called a model with <em>random intercepts</em>. Why <em>random</em>? This is because we can think of these effects as sampled from a population of possible effects. A fixed effect on the other hand has a fixed number of possible values. In the model we will create this will be time-points (three) and training conditions (two). These are fixed by design in the study, but participants has been sampled at random.</p>
<p>We will use the function <code>lmer()</code> from the package <code>lme</code> to fit mixed effects models.</p>
<p>Hold up! Why use this new stuff, can we not just use the <code>lm</code> function?</p>
<p>Let’s try. Before we do, we should agree that when fitting correlated data (data from the same participants sampled multiple times therefore creating data points “related” to each other) we violate an assumption of the ordinary linear model, the assumption of independence.</p>
<p>In the data we have for these examples, we have two groups. One group has performed training with multiple sets (3 exercises in legs, 2-3 sessions per week for twelve weeks) and the other group with a single set per exercise. Testing was done twice before the training period and once after. We will use time-points <code>pre</code> and <code>post</code> and exercise <code>isok.60</code> in this example.</p>
<p>Let’s start by fitting a model where we try to estimate the difference between groups over time using <code>lm()</code>.</p>
<pre class="r"><code>isok.data &lt;- read_csv(&quot;./data/strengthTests.csv&quot;) %&gt;% 
  filter(exercise == &quot;isok.60&quot;, 
         timepoint %in% c(&quot;pre&quot;, &quot;post&quot;)) %&gt;%
  # fix the order of timepoint factor
  mutate(timepoint = factor(timepoint, levels = c(&quot;pre&quot;, &quot;post&quot;))) %&gt;%
  
  print()


# The model

lm1 &lt;- lm(load ~ timepoint * group, data = isok.data)

summary(lm1)</code></pre>
<p>The model formulation estimates four parameters. The intercept is the mean in the multiple-set group at baseline (<code>pre</code>). <code>timepointpost</code> is the mean in the multiple-set group at time-point <code>post</code>. <code>groupsingle</code> is the difference at baseline between groups and <code>timepointpost:groupsingle</code> is the difference in single-set compared to multiple-set at time-point <code>post</code>. This is the parameter of interest in this model. We want to know if the change from pre to post differs between groups, we can assess this by testing if the difference is smaller or greater than zero. This is done with the difference at baseline in mind (we control for the baseline).</p>
<p>The model formulation contains an interaction, meaning that the two groups are allowed to change differently between time-points.</p>
<p>We can see that we estimate the difference to about -24 units. However, this is not significant.</p>
<p>Now let’s try to fit a mixed effects model.</p>
<pre class="r"><code># Load packages
library(lme4)

isok.data &lt;- read_csv(&quot;./data/strengthTests.csv&quot;) %&gt;% 
  filter(exercise == &quot;isok.60&quot;, 
         timepoint %in% c(&quot;pre&quot;, &quot;post&quot;)) %&gt;%
  # fix the order of timepoint factor
  mutate(timepoint = factor(timepoint, levels = c(&quot;pre&quot;, &quot;post&quot;))) %&gt;%
  
  print()


# The model
lmer1 &lt;- lmer(load ~ timepoint * group + (1|subject), data = isok.data)

summary(lmer1)</code></pre>
<p>From the fixed effects part of the summary, we can read about the same parameters. However the estimates differs from the linear model. We can also compare t-values, these differ considerably.</p>
<p>Notice that <code>lme4</code> does not produce p-values. If you write <code>?pvalues</code> in your console you will get some explanation to why.</p>
<p>Instead of p-values we can use confidence intervals to evaluate our fixed effects. These are accessed from both <code>lm</code>and <code>lmer</code> with the <code>confint</code> function.</p>
<pre class="r"><code># Confidence intervals from lm
confint(lm1)


# Confidence intervals from lmer
confint(lmer1)</code></pre>
<p>What is your interpretation of the results from these two models.</p>
<p>In this comparison we have seen that the mixed effects model is more powerful by accounting for correlated data.</p>
</div>
<div id="exercise" class="section level4">
<h4>Exercise</h4>
<p>Fit a mixed effects model to <code>isom</code> data from <code>pre</code> and <code>post</code> training. Interpret the model parameters and estimates.</p>
<a id="displayText" href="javascript:toggle(8);">Example code</a>
<div id="toggleText8" style="display: none">
<pre class="r"><code># Load packages
library(lme4)

isom.data &lt;- read_csv(&quot;./data/strengthTests.csv&quot;) %&gt;% 
  filter(exercise == &quot;isom&quot;, 
         timepoint %in% c(&quot;pre&quot;, &quot;post&quot;)) %&gt;%
  # fix the order of timepoint factor
  mutate(timepoint = factor(timepoint, levels = c(&quot;pre&quot;, &quot;post&quot;)))</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   subject = col_character(),
##   timepoint = col_character(),
##   exercise = col_character(),
##   load = col_double(),
##   sex = col_character(),
##   group = col_character()
## )</code></pre>
<pre class="r"><code># The model
lmer2 &lt;- lmer(load ~ timepoint * group + (1|subject), data = isom.data)</code></pre>
<p>The resulting model has the same parameters as in the previous example.</p>
<table>
<thead>
<tr class="header">
<th align="left">Parameter</th>
<th align="right">Estimate</th>
<th align="right">SE</th>
<th align="right">t-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">211.764706</td>
<td align="right">15.246856</td>
<td align="right">13.889074</td>
</tr>
<tr class="even">
<td align="left">timepointpost</td>
<td align="right">55.192016</td>
<td align="right">7.730208</td>
<td align="right">7.139784</td>
</tr>
<tr class="odd">
<td align="left">groupsingle</td>
<td align="right">3.264706</td>
<td align="right">21.562310</td>
<td align="right">0.151408</td>
</tr>
<tr class="even">
<td align="left">timepointpost:groupsingle</td>
<td align="right">-20.750839</td>
<td align="right">10.779550</td>
<td align="right">-1.925019</td>
</tr>
</tbody>
</table>
<p>The intercept is the mean in the reference group (multiple-set group) at <code>pre</code>. <code>timepointpost</code> is the mean in the reference group at time-point <code>post</code>. <code>groupsingle</code> is the difference at baseline between groups and <code>timepointpost:groupsingle</code> is the difference between single-set and multiple-set at time-point <code>post</code>. This is the parameter of interest in this model. We want to know if the change from pre to post differs between groups, we can assess this by testing if the difference is smaller or greater than zero. This is done with the difference at baseline in mind (we control for the baseline).</p>
<p>Using the <code>confint</code>we can see that the interaction term (<code>timepointpost:groupsingle</code>) contains zero.</p>
</div>
<p></br></p>
</div>
</div>
<div id="multiple-time-point-mixed-models" class="section level3">
<h3>Multiple time-point – Mixed models</h3>
<p>The model can be extended using all time-point, we do not anticipate any differences between time-points <code>pre</code> and <code>session1</code>, lets see if we are correct. We use the <code>isom</code> data.</p>
<pre class="r"><code># Load packages
library(lme4)

isom.data &lt;- read_csv(&quot;./data/strengthTests.csv&quot;) %&gt;% 
  filter(exercise == &quot;isom&quot;) %&gt;%
  # fix the order of timepoint factor
  mutate(timepoint = factor(timepoint, levels = c(&quot;pre&quot;, &quot;session1&quot;,&quot;post&quot;))) 



# The model
lmer3 &lt;- lmer(load ~ timepoint * group + (1|subject), data = isom.data)

summary(lmer3)</code></pre>
<p>Do your best to interpret the output from the model</p>
<a id="displayText" href="javascript:toggle(9);">An interpretation</a>
<div id="toggleText9" style="display: none">
<p>The mean in the multiple-set group at <code>pre</code> is 211.8 Nm. From <code>pre</code> to <code>session1</code> the multiple-set group increases by 6.1 Nm, from <code>pre</code> to <code>post</code> the multiple-set group increases by 54.4 Nm. At <code>pre</code> there is a 3.3 unit difference between groups. Given this difference, at time-point <code>session1</code> the single set group is -3.9 units lower than the multiple-sets group, and at time-point <code>post</code> the single-set group is -20 Nm lower than the multiple set group given a baseline difference and an increase in the multiple-set group.</p>
<p>By adding these terms we can get the estimated mean for each group at <code>post</code>:</p>
<p><code>multiple-set at post = (Intercept) + timepointpost</code></p>
<p><code>single-set at post = (Intercept) + timepointpost + groupsingle + timepointpost:groupsingle</code></p>
</div>
<p></br></p>
</div>
<div id="diagnostics" class="section level3">
<h3>Diagnostics</h3>
<p>The same rules apply for the mixed effects model as for the ordinary linear model (except for the independence assumption). Using simple commands we can first check the residual plot:</p>
<p><code>plot(lmer2)</code></p>
<p>The residuals should show no pattern.</p>
<p>We can also make a qqplot of the residuals to check for normality:</p>
<p><code>qqnorm(resid(lmer2)); qqline(resid(lmer2))</code></p>
<p>This is really two commands separated with a <code>;</code> . The first plots the data, the second adds the line.</p>
</div>
<div id="more-about-mixed-effects-models" class="section level3">
<h3>More about mixed effects models</h3>
<p>We have only scratched the surface. The models can be extended far beyond this course but if you do an experiment in your master thesis, I’m pretty sure you will analyze it with a mixed model! I might be a good idea to read further.</p>
<p>This is a nice paper (the first part is a general introduction):</p>
<p>Harrison, X. A., et al. (2018). “A brief introduction to mixed effects modelling and multi-model inference in ecology.” PeerJ 6: e4794-e4794.</p>
</div>
<div id="references" class="section level3 unnumbered">
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-senn2006">
<p>Senn, S. 2006. “Change from Baseline and Analysis of Covariance Revisited.” Journal Article. <em>Stat Med</em> 25 (24): 4334–44. <a href="https://doi.org/10.1002/sim.2682">https://doi.org/10.1002/sim.2682</a>.</p>
</div>
<div id="ref-vickers2001">
<p>Vickers, Andrew J., and Douglas G. Altman. 2001. “Analysing Controlled Trials with Baseline and Follow up Measurements.” Journal Article. <em>BMJ : British Medical Journal</em> 323 (7321): 1123–4. <a href="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC1121605/%0Ahttps://www.ncbi.nlm.nih.gov/pmc/articles/PMC1121605/pdf/1123.pdf">http://www.ncbi.nlm.nih.gov/pmc/articles/PMC1121605/
https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1121605/pdf/1123.pdf</a>.</p>
</div>
</div>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
